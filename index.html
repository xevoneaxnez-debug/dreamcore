<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DreamCore</title>
  <link rel="manifest" href="manifest.json">
  <style>
    :root {
      --bg-color: #ffffff;
      --text-color: #000000;
      --primary-color: #6200ea;
      --sidebar-bg: #f5f5f5;
      --card-bg: #fff;
      --button-bg: #6200ea;
      --button-color: #fff;
    }

    [data-theme="dark"] {
      --bg-color: #121212;
      --text-color: #ffffff;
      --primary-color: #bb86fc;
      --sidebar-bg: #1e1e1e;
      --card-bg: #1f1f1f;
      --button-bg: #bb86fc;
      --button-color: #000;
    }

    body {
      margin: 0;
      font-family: 'Roboto', sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
      display: flex;
      height: 100vh;
      overflow: hidden;
      transition: background-color 0.3s, color 0.3s;
    }

    /* Sidebar */
    .sidebar {
      width: 0;
      background: var(--sidebar-bg);
      overflow-x: hidden;
      transition: width 0.3s;
      padding: 20px 10px;
      box-shadow: 2px 0 5px rgba(0,0,0,0.2);
    }

    .sidebar.open {
      width: 250px;
    }

    .sidebar h3 {
      margin-top: 0;
      margin-bottom: 10px;
    }

    .sidebar button {
      width: 100%;
      margin: 5px 0;
      padding: 10px;
      background: var(--button-bg);
      color: var(--button-color);
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
    }

    .sidebar ul {
      list-style: none;
      padding: 0;
      margin-top: 10px;
      max-height: 70vh;
      overflow-y: auto;
    }

    .sidebar ul li {
      padding: 10px;
      margin-bottom: 5px;
      border-radius: 6px;
      cursor: pointer;
      background: var(--card-bg);
      box-shadow: 0 1px 3px rgba(0,0,0,0.2);
    }

    .sidebar ul li:hover {
      background: var(--primary-color);
      color: #fff;
    }

    /* Main content */
    .main {
      flex: 1;
      display: flex;
      flex-direction: column;
      transition: margin-left 0.3s;
    }

    .topbar {
      background: var(--primary-color);
      color: #fff;
      padding: 15px 20px;
      font-size: 20px;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .topbar button {
      background: #fff;
      color: var(--primary-color);
      border-radius: 50px;
      font-size: 14px;
      padding: 5px 10px;
    }

    .note-container {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
    }

    .note-card {
      background: var(--card-bg);
      color: var(--text-color);
      padding: 15px;
      width: 200px;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
      display: flex;
      flex-direction: column;
    }

    .note-card textarea {
      width: 100%;
      border: none;
      resize: none;
      background: transparent;
      color: var(--text-color);
      font-size: 14px;
      flex: 1;
    }

    .note-card button {
      margin-top: 10px;
      background: var(--button-bg);
      color: var(--button-color);
      border-radius: 5px;
      padding: 5px;
    }

  </style>
</head>
<body data-theme="light">

<div class="sidebar" id="sidebar">
  <button onclick="toggleSidebar()">Close</button>
  <button onclick="toggleTheme()">Toggle Dark/Light</button>
  <h3>Notes</h3>
  <ul id="notesList"></ul>
  <button onclick="createNewNote()">+ New Note</button>
</div>

<div class="main" id="main">
  <div class="topbar">
    DreamCore
    <button onclick="toggleSidebar()">â˜°</button>
  </div>
  <div class="note-container" id="noteContainer"></div>
</div>

<script>
  const sidebar = document.getElementById('sidebar');
  const noteContainer = document.getElementById('noteContainer');
  const notesList = document.getElementById('notesList');

  // Theme
  function setTheme(theme) {
    document.body.setAttribute('data-theme', theme);
    localStorage.setItem('dreamcore-theme', theme);
  }

  function toggleTheme() {
    const current = document.body.getAttribute('data-theme');
    setTheme(current === 'light' ? 'dark' : 'light');
  }

  const savedTheme = localStorage.getItem('dreamcore-theme') || 'light';
  setTheme(savedTheme);

  // Sidebar
  function toggleSidebar() {
    sidebar.classList.toggle('open');
  }

  // Notes
  let notes = JSON.parse(localStorage.getItem('dreamcore-notes')) || [];

  function saveNotes() {
    localStorage.setItem('dreamcore-notes', JSON.stringify(notes));
    renderNotesList();
  }

  function renderNotesList() {
    notesList.innerHTML = '';
    notes.forEach((note, idx) => {
      const li = document.createElement('li');
      li.textContent = note.slice(0, 20) || 'Untitled';
      li.onclick = () => editNote(idx);
      notesList.appendChild(li);
    });
    renderNoteCards();
  }

  function createNewNote() {
    notes.push('');
    saveNotes();
  }

  function editNote(index) {
    const textarea = document.getElementById('note-' + index);
    if (textarea) {
      textarea.focus();
    }
  }

  function renderNoteCards() {
    noteContainer.innerHTML = '';
    notes.forEach((note, idx) => {
      const card = document.createElement('div');
      card.className = 'note-card';
      const textarea = document.createElement('textarea');
      textarea.id = 'note-' + idx;
      textarea.value = note;
      textarea.addEventListener('input', () => {
        notes[idx] = textarea.value;
        saveNotes();
      });

      const deleteBtn = document.createElement('button');
      deleteBtn.textContent = 'Delete';
      deleteBtn.onclick = () => {
        notes.splice(idx,1);
        saveNotes();
      };

      card.appendChild(textarea);
      card.appendChild(deleteBtn);
      noteContainer.appendChild(card);
    });
  }

  renderNotesList();

  // Service Worker
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('sw.js')
      .then(() => console.log('Service Worker Registered'))
      .catch(err => console.error('Service Worker failed:', err));
  }

</script>
</body>
</html>